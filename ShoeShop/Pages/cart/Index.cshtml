@page
@model ShoeShop.Pages.cart.IndexModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Giỏ Hàng";
    Layout = "~/Pages/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

<div class="row cart">
    <div class="col-md-12">
        <h2>GIỎ HÀNG</h2>
        <div class="box-cart">
            <div class="box-cart-item-box">
                @if (Model.Carts != null && Model.Carts.Any())
                {
                    foreach (var item in Model.Carts)
                    {
                        <div class="box-cart-item d-flex justify-content-start align-items-center">
                            <img src="@item.Image" alt="@item.Name" class="box-cart-item-img" />
                            <div class="d-flex flex-column">
                                <h5>@item.Name</h5>
                                <form method="post" asp-page-handler="Update" asp-route-id="@item.Id">
                                    <div class="box-cart-item-btn">
                                      @*   <button type="submit" class="btn qty_btn decrease" name="quantity" value="@Math.Max(item.Quantity - 1, 0)"><i class="fa fa-minus"></i></button> *@
                                        <input type="number" class="qty_input" name="quantity" value="@item.Quantity" min="0" id="qty-@item.Id" />
                                        @* <button type="submit" class="btn qty_btn increase" name="quantity" value="@item.Quantity + 1"><i class="fa fa-plus"></i></button> *@
                                        <button type="submit" class="btn update">Cập nhật</button>
                                    </div>
                                    <p>Giá: <span>@string.Format("{0:#,##0}", item.Price)</span> VND</p>
                                    <p>Thành tiền: <span>@string.Format("{0:#,##0}", item.Total)</span> VND</p>
                                </form>
                            </div>

                            <div class="btn-action">
                                <a asp-page="/Cart/Index" asp-page-handler="Remove" asp-route-id="@item.Id" class="btn remove">
                                    <i class="fa-solid fa-xmark"></i>
                                </a>

                            </div>
                        </div>
                    }
                }
                else
                {
                    <p>Giỏ hàng trống.</p>
                }
            </div>
            <div class="box-cart-bill">
                <h3>Tóm tắt đơn hàng</h3>
                <p>
                    Tổng thành tiền:
                    <span id="totalMoney">
                        @if (ViewBag.total != null)
                        {
                            @string.Format("{0:#,##0}", ViewBag.total)
                        }
                        else
                        {
                            <span>0</span>
                        }
                    </span> VND
                </p>
                <p>
                    Phí vận chuyển: <span class="ship-money">Free Ship</span><br>
                    <small>(Miễn phí vận chuyển với đơn hàng trên 10 triệu)</small>
                </p>
                <p>
                    Thông tin vận chuyển: Sản phẩm sẽ được Hoàng Hoan giao trong vòng 2-7 ngày.
                    Chi tiết liên hệ <a href="tel:0978611889">0978 611 889</a>
                </p>
                <div class="cart-box cart-layout">
                    <div>
                        Tổng tiền: <span id="totalMoneyPay">
                            @if (ViewBag.total != null)
                            {
                                @string.Format("{0:#,##0}", ViewBag.total)
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </span> VND
                    </div>
                    <div class="group-btn">
                        <a asp-page="/Cart/Checkout" class="btn">Đặt hàng ngay</a>
                        <a href="/product" class="btn">Tiếp tục mua hàng</a>
                        @if (TempData["SuccessMessage"] != null)
                        {
                            <span class="success-message">@TempData["SuccessMessage"]</span>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

